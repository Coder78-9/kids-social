<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Kids social - feed</title>

    <style>
        body {
            display: flex;
            justify-content: center;       /* fixed typo */
            align-items: center;           /* fixed typo */
            min-height: 100vh;             /* fixed typo */
            background: #EFCEF0;
            margin: 0;
            font-family: sans-serif;
        }

        .container {
            background: white;
            padding: 20px;
            width: 300px;
            border-radius: 10px;
        }

        .post-box {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Kids feed</h1>
    <p>You are logged in — make a post!</p>

    <h2>Create a post</h2>
    <input id="post-text" placeholder="Write something...">
    <button id="post-button">Post</button>

    <h2>All posts</h2>
    <div id="posts"></div>
</div>

<script type="module">
    // 1. Firebase imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { 
        getAuth, 
        onAuthStateChanged 
    } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

    import { 
        getFirestore, 
        collection, 
        addDoc, 
        onSnapshot 
    } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

    // 2. Firebase config
    const firebaseConfig = {
        apiKey: "AIzaSyA6IRJ_0LNbb1KOZt_G174pgYsjDx6zPm4",
        authDomain: "kids-social-5b36f.firebaseapp.com",
        projectId: "kids-social-5b36f",
        storageBucket: "kids-social-5b36f.firebasestorage.app",
        messagingSenderId: "916072443602",
        appId: "1:916072443602:web:eb7dbd40082a66494f470b",
        measurementId: "G-CPCZ7M68PW"
    };

    // 3. Init Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // 4. Redirect if NOT logged in
    onAuthStateChanged(auth, (user) => {
        if (!user) {
            window.location.href = "index.html";
        }
    });

    // 5. DOM elements
    const postInput = document.getElementById("post-text");
    const postButton = document.getElementById("post-button");
    const postsDiv = document.getElementById("posts");

    // 6. Create a post
    postButton.addEventListener("click", () => {
        const text = postInput.value; 
        //! replace postInput → your input element
        //! replace text → the message the user typed

        if (text === "") {
            // nothing
        } else {
            addDoc(
                collection(db, "posts"), 
                //! replace db → your Firestore database
                //! replace "posts" → your Firestore collection name

                {
                    text: text,
                    //! replace text → the message being posted

                    user: auth.currentUser.email,
                    //! replace auth.currentUser.email → the logged-in user's email

                    time: Date.now()
                    //! replace Date.now() → timestamp
                }
            );

            postInput.value = "";
            //! replace postInput → input box (clears it)
        }
    });

    // 7. Show posts live
    onSnapshot(collection(db, "posts"), (snapshot) => {
        postsDiv.innerHTML = "";
        //! replace postsDiv → the div where posts appear

        snapshot.forEach((doc) => {
            const info = doc.data(); 
            //! replace info → {text, user, time}

            const box = document.createElement("div");
            //! replace box → HTML element for a single post

            box.classList.add("post-box");
            box.innerHTML = `
                <p><strong>${info.user}</strong></p>
                //! replace info.user → user email

                <p>${info.text}</p>
                //! replace info.text → post message
            `;

            postsDiv.appendChild(box);
            //! replace postsDiv → posts container
        });
    });

</script>

</body>
</html>





    

